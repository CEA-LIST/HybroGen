/******************************************************************************/
/* test_twiddle.hl :                                                          */
/* - The goal of this function to check whether or not the pre-computing of   */
/*   the twiddle factors generated by gen_c_header.py are accurate, even at   */
/*   fixed-point.                                                             */
/******************************************************************************/
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#include <fft_utils.h>

int main(void)
{
	float t, x;
	uint16_t ft, fx;
	printf("- TwiddleFactors Test\n");
	printf("  * Fixed-point precision is %d-bit\n", PRECISION_BITS);
	printf("  * Max. Sample Length is %d-bit\n", MAX_SAMPLE_LENGTH);
	for(int i = 0; i <= (int)log2(MAX_SAMPLE_LENGTH); i += 1)
	{
		ft = twiddle(i);
		t = fixed_to_flt(twiddle(i));
		x = exp(-2 * M_PI / (1 << i));
		fx = flt_to_fixed(x);
		printf("n=%02d : Expected %.3f (%d / %.3f), Generated %d / %.3f\n",
				i, x, fx, fixed_to_flt(fx), ft, t);
	}
	return EXIT_SUCCESS;
}
